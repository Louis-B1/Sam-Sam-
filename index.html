<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mission: Samuel √† Paris ‚Äì Enhanced</title>

<style>
:root {
  --bg: #0b0f1a;
  --primary: #00eaff;
  --accent: #ff2e88;
  --warning: #f1c40f;
  --success: #2ecc71;
  --dark: #111;
}

* { box-sizing: border-box; }

body {
  margin: 0;
  background: radial-gradient(circle at top, #121833, var(--bg));
  color: white;
  font-family: system-ui, monospace;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  overflow: hidden;
  user-select: none;
}

/* UI */
#ui {
  position: absolute;
  top: 16px;
  left: 16px;
  padding: 12px 16px;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(10px);
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,.6);
  font-size: 14px;
}

#msg {
  position: absolute;
  bottom: 20px;
  padding: 12px 20px;
  background: rgba(0,0,0,.65);
  border-radius: 30px;
  animation: pop .3s ease;
}

@keyframes pop {
  from { transform: scale(.7); opacity: 0 }
  to { transform: scale(1); opacity: 1 }
}

button {
  margin-top: 10px;
  padding: 12px 24px;
  background: linear-gradient(135deg, var(--accent), var(--primary));
  border: none;
  border-radius: 30px;
  color: white;
  font-weight: bold;
  cursor: pointer;
  transition: .2s;
}

button:hover {
  transform: scale(1.05);
  box-shadow: 0 0 20px var(--accent);
}

canvas {
  background: #050505;
  border-radius: 16px;
  box-shadow: 0 0 60px rgba(0,0,0,.8);
}
</style>
</head>

<body>

<div id="ui">
  ‚ù§Ô∏è <span id="life">3</span><br>
  üéí <span id="items">0</span>
</div>

<div id="msg" style="display:none"></div>

<canvas id="game" width="480" height="480"></canvas>

<script>
/* ==========================
   CORE
========================== */

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const TILE = 32;
const GRID = 15;

let last = 0;
let freeze = 0;

/* ==========================
   CAMERA (Screen Shake)
========================== */
class Camera {
  constructor() { this.shake = 0; }
  hit(v=6){ this.shake = v; }
  apply() {
    if(this.shake>0){
      ctx.translate(
        (Math.random()-.5)*this.shake,
        (Math.random()-.5)*this.shake
      );
      this.shake *= .85;
    }
  }
}
const camera = new Camera();

/* ==========================
   PARTICLES
========================== */
const particles = [];

function emit(x,y,color,count=10){
  for(let i=0;i<count;i++){
    particles.push({
      x,y,
      vx:(Math.random()-.5)*4,
      vy:(Math.random()-.5)*4,
      life:30,
      color
    });
  }
}

/* ==========================
   PLAYER
========================== */
const player = {
  x: 1, y: 1,
  life: 3,
  items: 0,
  bump: 0
};

function move(dx,dy){
  const nx = player.x + dx;
  const ny = player.y + dy;
  if(nx<0||ny<0||nx>=GRID||ny>=GRID) return;

  player.x = nx;
  player.y = ny;
  player.bump = 1;
}

/* ==========================
   ENEMY
========================== */
const enemies = [
  {x:7,y:7,dir:1}
];

/* ==========================
   ITEM
========================== */
const items = [
  {x:4,y:4,collected:false},
  {x:10,y:2,collected:false},
  {x:12,y:12,collected:false}
];

/* ==========================
   MAP
========================== */
const map = Array.from({length:GRID},(_,y)=>
  Array.from({length:GRID},(_,x)=>
    x===0||y===0||x===GRID-1||y===GRID-1 ? 1 : 0
  )
);

/* ==========================
   MESSAGE
========================== */
function showMsg(t){
  const m=document.getElementById("msg");
  m.innerText=t;
  m.style.display="block";
  setTimeout(()=>m.style.display="none",2000);
}

/* ==========================
   UPDATE
========================== */
function update(dt){
  if(freeze>0){ freeze-=dt; return; }

  // enemies
  enemies.forEach(e=>{
    e.y += e.dir * dt * .002;
    if(e.y<1||e.y>GRID-2) e.dir*=-1;
    if(e.x===player.x && Math.floor(e.y)===player.y){
      player.life--;
      camera.hit();
      emit(player.x*TILE+16,player.y*TILE+16,"#ff2e88");
      freeze=80;
      showMsg("üí• Touch√© !");
    }
  });

  // items
  items.forEach(i=>{
    if(!i.collected && i.x===player.x && i.y===player.y){
      i.collected=true;
      player.items++;
      emit(i.x*TILE+16,i.y*TILE+16,"#f1c40f",20);
      showMsg("‚úÖ Objet r√©cup√©r√©");
    }
  });

  player.bump*=.8;
}

/* ==========================
   DRAW
========================== */
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.save();
  camera.apply();

  // map
  for(let y=0;y<GRID;y++){
    for(let x=0;x<GRID;x++){
      ctx.fillStyle = map[y][x] ? "#222" : "#0f162a";
      ctx.fillRect(x*TILE,y*TILE,TILE,TILE);
    }
  }

  // items
  items.forEach(i=>{
    if(!i.collected){
      ctx.fillStyle="#f1c40f";
      ctx.beginPath();
      ctx.arc(i.x*TILE+16,i.y*TILE+16,6,0,Math.PI*2);
      ctx.fill();
    }
  });

  // enemies
  enemies.forEach(e=>{
    ctx.fillStyle="#ff2e88";
    ctx.fillRect(e.x*TILE+8,e.y*TILE+8,16,16);
  });

  // player
  ctx.save();
  ctx.translate(player.x*TILE+16,player.y*TILE+16);
  ctx.scale(1+player.bump*.2,1-player.bump*.2);
  ctx.fillStyle="#00eaff";
  ctx.fillRect(-10,-10,20,20);
  ctx.restore();

  ctx.restore();
}

/* ==========================
   LOOP
========================== */
function loop(t){
  const dt = t-last; last=t;
  update(dt);
  draw();
  document.getElementById("life").innerText = player.life;
  document.getElementById("items").innerText = player.items;
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

/* ==========================
   INPUT
========================== */
window.addEventListener("keydown",e=>{
  if(e.key==="ArrowUp") move(0,-1);
  if(e.key==="ArrowDown") move(0,1);
  if(e.key==="ArrowLeft") move(-1,0);
  if(e.key==="ArrowRight") move(1,0);
});
</script>
</body>
</html>
